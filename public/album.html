<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <title>Album Details</title>
</head>
<body>
<nav>
    <div class="navbar-left">
        <a href="index.html">Home</a>
    </div>
    <div class="navbar-center">
        MusicBrainz API
    </div>
    <div class="navbar-right">
        <div class="dropdown">
            <button class="dropbtn">Menu <i class="fa fa-caret-down"></i></button>
            <div class="dropdown-content">
                <a href="index.html">Home</a>
            </div>
        </div>
    </div>
</nav>
<div class="album-container">
    <div class="album-cover-container">
        <img id="album-cover" class="album-cover" src="" alt="Album Cover">
    </div>
    <div class="album-info">
        <h1 id="album-title"></h1>
        <h2 id="album-artist"></h2>
        <h3 id="album-year"></h3>
        <ol id="songs"></ol>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const params = new URLSearchParams(window.location.search);
        const albumId = params.get('id');
        if (!albumId) {
            document.getElementById('album-info').innerText = 'No album ID provided';
            return;
        }

        try {
            const response = await fetch(`/getAlbumDetails.php?id=${albumId}`);
            const data = await response.json();
            if (data.error) {
                document.getElementById('album-info').innerText = data.error;
            } else {
                document.getElementById('album-cover').src = `https://coverartarchive.org/release-group/${albumId}/front-500`;
                document.getElementById('album-title').innerText = data.title;
                document.getElementById('album-artist').innerText = data['artist-credit'][0].name;
                document.getElementById('album-year').innerText = new Date(data['first-release-date']).getFullYear();

                const recordings = data.relations.filter(rel => rel.type === 'recording');
                recordings.forEach((recording, index) => {
                    const li = document.createElement('li');
                    li.innerText = recording.title;
                    document.getElementById('songs').appendChild(li);
                });
            }
        } catch (error) {
            console.error('Error fetching album data:', error);
            document.getElementById('album-info').innerText = 'Error fetching album data';
        }
    });
</script>
</body>
</html>
